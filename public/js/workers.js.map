{"version":3,"sources":["../../src/js/workers.js"],"names":["Worker","props","Object","assign","pic","workerID","prodpic","production","owned","save","id","ResourceManager","materialIcon","WorkerManager","workers","canProduceBucket","addWorker","worker","push","createSave","forEach","w","loadSave","workerByID","find","gainWorker","refreshSideWorkers","refreshRecipeFilters","recipeList","canCraft","refreshProgress","refreshAllGuildWorkers","canCurrentlyProduce","couldCraft","item","canProduce","filter","map","groupArray","needBucket","gcost","entries","res","amt","undefined","canCurrentlyCraft","filterByGuild","guildID","r","guildUnlock","getNextGuildLevel","lvl","guilds","left","g","repReqForBuy","sort","a","b","freeByGuild","gid","usage","actionSlotManager","guildUsage","ownedByGuild","length","getCurrentProduceAvailable","$G001WorkerFree","$","$G002WorkerFree","$G003WorkerFree","$G004WorkerFree","$G001WorkersSide","$G002WorkersSide","$G003WorkersSide","$G004WorkersSide","g1free","g2free","g3free","g4free","html","removeClass","addClass","show","hide"],"mappings":"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","sourcesContent":["\"use strict\";\r\n\r\nclass Worker {\r\n    constructor(props) {\r\n        Object.assign(this, props);\r\n        this.pic = '<img src=\"/assets/images/workers/'+this.workerID+'.gif\">';\r\n        this.prodpic = '<img src=\"/assets/images/resources/'+this.production+'.png\">';\r\n        this.owned = false;\r\n    }\r\n    createSave() {\r\n        const save = {};\r\n        save.id = this.workerID;\r\n        save.owned = this.owned;\r\n        return save;\r\n    }\r\n    loadSave(save) {\r\n        this.owned = save.owned;\r\n    }\r\n    productionText() {\r\n        return `<span class=\"production_type\">${ResourceManager.materialIcon(this.production)}</span><span class=\"production_text\">Worker</span>`;\r\n    }\r\n}\r\n\r\nconst WorkerManager = {\r\n    workers : [],\r\n    canProduceBucket : {},\r\n    addWorker(worker) {\r\n        this.workers.push(worker);\r\n    },\r\n    createSave() {\r\n        const save = [];\r\n        this.workers.forEach(w=> {\r\n            save.push(w.createSave());\r\n        });\r\n        return save;\r\n    },\r\n    loadSave(save) {\r\n        save.forEach(w=> {\r\n            const worker = this.workerByID(w.id);\r\n            worker.loadSave(w);\r\n        });\r\n    },\r\n    workerByID(id) {\r\n        return this.workers.find(worker => worker.workerID === id);\r\n    },\r\n    gainWorker(workerID) {\r\n        const worker = this.workerByID(workerID);\r\n        worker.owned = true;\r\n        refreshSideWorkers();\r\n        refreshRecipeFilters();\r\n        recipeList.canCraft();\r\n        refreshProgress();\r\n        refreshAllGuildWorkers();\r\n    },\r\n    canCurrentlyProduce() {\r\n\r\n    },\r\n    couldCraft(item) {\r\n        const canProduce = this.workers.filter(w=> w.owned).map(w=>w.production);\r\n        const canProduceBucket = groupArray(canProduce);\r\n        const needBucket = groupArray(item.gcost);\r\n        for (const [res, amt] of Object.entries(needBucket)) {\r\n            if (canProduceBucket[res] === undefined || canProduceBucket[res] < amt) return false;\r\n        }\r\n        return true;\r\n    },\r\n    canCurrentlyCraft(item) {\r\n        const needBucket = groupArray(item.gcost);\r\n        for (const [res, amt] of Object.entries(needBucket)) {\r\n            if (this.canProduceBucket[res] === undefined || this.canProduceBucket[res] < amt) return false;\r\n        }\r\n        return true;\r\n    },\r\n    filterByGuild(guildID) {\r\n        return this.workers.filter(r=>r.guildUnlock === guildID);\r\n    },\r\n    getNextGuildLevel(id,lvl) {\r\n        const guilds = this.filterByGuild(id);\r\n        const left = guilds.filter(g => g.repReqForBuy() > lvl);\r\n        return left.sort((a,b) => a.repReqForBuy() - b.repReqForBuy())[0];\r\n    },\r\n    freeByGuild(gid) {\r\n        const usage = actionSlotManager.guildUsage();\r\n        if (usage[gid] === undefined) return this.ownedByGuild(gid);\r\n        return this.ownedByGuild(gid) - usage[gid];\r\n    },\r\n    ownedByGuild(gid) {\r\n        return this.workers.filter(w => w.production === gid && w.owned).length;\r\n    },\r\n    getCurrentProduceAvailable() {\r\n        const gid = [\"G001\",\"G002\",\"G003\",\"G004\"];\r\n        const canProduceBucket = {};\r\n        gid.forEach(g => {\r\n            canProduceBucket[g] = this.freeByGuild(g);\r\n        });\r\n        return canProduceBucket;\r\n    }\r\n}\r\n\r\nconst $G001WorkerFree = $(\"#G001WorkerFree\");\r\nconst $G002WorkerFree = $(\"#G002WorkerFree\");\r\nconst $G003WorkerFree = $(\"#G003WorkerFree\");\r\nconst $G004WorkerFree = $(\"#G004WorkerFree\");\r\nconst $G001WorkersSide = $(\"#G001WorkersSide\");\r\nconst $G002WorkersSide = $(\"#G002WorkersSide\");\r\nconst $G003WorkersSide = $(\"#G003WorkersSide\");\r\nconst $G004WorkersSide = $(\"#G004WorkersSide\");\r\n\r\nfunction refreshSideWorkers() {\r\n    const g1free = WorkerManager.freeByGuild(\"G001\");\r\n    const g2free = WorkerManager.freeByGuild(\"G002\");\r\n    const g3free = WorkerManager.freeByGuild(\"G003\");\r\n    const g4free = WorkerManager.freeByGuild(\"G004\");\r\n    $G001WorkerFree.html(g1free);\r\n    $G002WorkerFree.html(g2free);\r\n    $G003WorkerFree.html(g3free);\r\n    $G004WorkerFree.html(g4free);\r\n    if (g1free > 0) $G001WorkersSide.removeClass(\"noWorkersAvailable\");\r\n    else $G001WorkersSide.addClass(\"noWorkersAvailable\");\r\n    if (g2free > 0) $G002WorkersSide.removeClass(\"noWorkersAvailable\");\r\n    else $G002WorkersSide.addClass(\"noWorkersAvailable\");\r\n    if (g3free > 0) $G003WorkersSide.removeClass(\"noWorkersAvailable\");\r\n    else $G003WorkersSide.addClass(\"noWorkersAvailable\");\r\n    if (g4free > 0) $G004WorkersSide.removeClass(\"noWorkersAvailable\");\r\n    else $G004WorkersSide.addClass(\"noWorkersAvailable\");\r\n    if (WorkerManager.ownedByGuild(\"G001\") > 0) $G001WorkersSide.show();\r\n    else $G001WorkersSide.hide();\r\n    if (WorkerManager.ownedByGuild(\"G002\") > 0) $G002WorkersSide.show();\r\n    else $G002WorkersSide.hide();\r\n    if (WorkerManager.ownedByGuild(\"G003\") > 0) $G003WorkersSide.show();\r\n    else $G003WorkersSide.hide();\r\n    if (WorkerManager.ownedByGuild(\"G004\") > 0) $G004WorkersSide.show();\r\n    else $G004WorkersSide.hide();\r\n};"],"file":"workers.js"}