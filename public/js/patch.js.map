{"version":3,"sources":["../../src/js/patch.js"],"names":["PatchManager","patchList","current","time","addPatch","patchNote","firstLoad","push","Math","max","patchCount","lastPatch","map","p","highest","find","lastVersion","version","lastPatchCount","updateNeeded","patchTimer","elapsed","$","ajax","url","done","data","each","i","props","patch","PatchNote","refreshPatchNotes","Object","assign","addClass","showPatchNotes","empty","forEach","d","html","appendTo","date","body","prepend","show","hide","document","on","e","location","replace"],"mappings":"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","sourcesContent":["\"use strict\";\r\n\r\nconst PatchManager = {\r\n    patchList: [],\r\n    current : 0,\r\n    time : 0,\r\n    addPatch(patchNote,firstLoad) {\r\n        this.patchList.push(patchNote);\r\n        if (firstLoad) this.current = Math.max(this.current,patchNote.patchCount);\r\n    },\r\n    lastPatch() {\r\n        const patchCount = this.patchList.map(p=>p.patchCount);\r\n        const highest = Math.max(...patchCount);\r\n        return this.patchList.find(p => p.patchCount === highest);\r\n    },\r\n    lastVersion() {\r\n        return this.lastPatch().version;\r\n    },\r\n    lastPatchCount() {\r\n        return this.lastPatch().patchCount;\r\n    },\r\n    updateNeeded() {\r\n        return this.current < this.lastPatchCount();\r\n    },\r\n    patchTimer(elapsed) {\r\n        this.time += elapsed;\r\n        if (this.time > 300000) {\r\n            this.patchList = [];\r\n            $.ajax({\r\n                url: \"json/patchNotes.json\",\r\n            }).done((data) => {\r\n                $.each(data, function(i,props){\r\n                    const patch = new PatchNote(props);\r\n                    PatchManager.addPatch(patch,false);\r\n                });\r\n                refreshPatchNotes();\r\n            });\r\n            this.time = 0;\r\n        }\r\n    }\r\n}\r\n\r\nclass PatchNote {\r\n    constructor(props) {\r\n        Object.assign(this, props);\r\n    }\r\n}\r\n\r\nfunction refreshPatchNotes() {\r\n    if (PatchManager.updateNeeded()) $(\"#versionNum\").addClass(\"hasEvent\");\r\n}\r\n\r\nfunction showPatchNotes() {\r\n    $(\"#patchList\").empty();\r\n    PatchManager.patchList.forEach(patch => {\r\n        const d = $(\"<div/>\").addClass(\"patchNote\");\r\n            $(\"<div/>\").addClass(\"patchNoteVersion\").html(patch.version).appendTo(d);\r\n            $(\"<div/>\").addClass(\"patchNoteDate\").html(`Updated ${patch.date}`).appendTo(d);\r\n            $(\"<div/>\").addClass(\"patchNoteBody\").html(patch.body).appendTo(d);\r\n        $(\"#patchList\").prepend(d);\r\n    });\r\n    if (PatchManager.updateNeeded()) $(\"#updateRefresh\").show();\r\n    else $(\"#updateRefresh\").hide();\r\n}\r\n\r\n$(document).on(\"click\",\"#updateRefresh\", (e) => {\r\n    location.replace('/');\r\n});"],"file":"patch.js"}