{"version":3,"sources":["../../src/js/playfab.js"],"names":["PlayFab","settings","titleId","sessionID","saveFile","$","document","on","e","show","hide","getSaveFromCloud","preventDefault","registerAcct","loginAcct","resetPassword","saveToCloud","loadFromCloud","validateCallback","result","error","resetRequest","TitleId","Email","val","PlayFabClientSDK","SendAccountRecoveryEmail","resetCallback","html","setTimeout","setDialogClose","GenerateErrorReport","empty","registerRequest","Password","RequireBothUsernameAndEmail","RegisterPlayFabUser","registerCallback","loginRequest","LoginWithEmailAddress","LoginCallback","data","SessionTicket","forceSave","requestData","Data","createSaveExport","ClientApi","UpdateUserData","saveCallback","localStorage","setItem","JSON","stringify","location","replace","Keys","GetUserData","loadCallback","parse","pako","ungzip","atob","savestring","Value","to","date","dateString","Date","toString","text"],"mappings":"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","sourcesContent":["PlayFab.settings.titleId = \"D765\";\r\n\r\nlet sessionID = null;\r\nlet saveFile = 0;\r\n\r\n$(document).on(\"click\", \"#cloudSave\", (e) => {\r\n    //clicked on the \"Cloud Save\" button\r\n    if (!sessionID) {\r\n        $(\"#pfLoginRegister\").show();\r\n        $(\"#pfImportExport\").hide();\r\n        $(\"#loadSure\").hide();\r\n    } else {\r\n        $(\"#pfLoginRegister\").hide();\r\n        $(\"#pfImportExport\").show();\r\n        $(\"#loadSure\").hide();\r\n        getSaveFromCloud();\r\n    }\r\n})\r\n\r\n$(document).on(\"click\", \"#register\", (e) => {\r\n    e.preventDefault();\r\n    registerAcct();\r\n})\r\n\r\n$(document).on(\"click\", \"#login\", (e) => {\r\n    e.preventDefault();\r\n    loginAcct();\r\n})\r\n\r\n$(document).on(\"click\", \"#reset\", (e) => {\r\n    resetPassword();\r\n})\r\n\r\n\r\n$(document).on(\"click\", \"#pfSave\", (e) => {\r\n    e.preventDefault();\r\n    saveToCloud();\r\n})\r\n\r\n$(document).on(\"click\", \"#pfLoad\", (e) => {\r\n    e.preventDefault();\r\n    $(\"#loadSure\").show();\r\n    $(\"#pfImportExport\").hide();\r\n})\r\n\r\n$(document).on(\"click\", \"#pfloadYes\", (e) => {\r\n    loadFromCloud();\r\n})\r\n\r\n$(document).on(\"click\", \"#pfloadNo\", (e) => {\r\n    $(\"#pfLoginRegister\").show();\r\n    $(\"#pfImportExport\").hide();\r\n    $(\"#loadSure\").hide();\r\n})\r\n\r\nconst validateCallback = function (result, error) {\r\n    if (error !== null) {\r\n        $(\"#pfLoginRegister\").show();\r\n        $(\"#pfImportExport\").hide();\r\n    }\r\n    else {\r\n        $(\"#pfLoginRegister\").hide();\r\n        $(\"#pfImportExport\").show();\r\n    }\r\n}\r\n\r\nfunction resetPassword() {\r\n    const resetRequest = {\r\n        TitleId: PlayFab.settings.titleId,\r\n        Email : $(\"#email\").val()\r\n    };\r\n    PlayFabClientSDK.SendAccountRecoveryEmail(resetRequest, resetCallback);\r\n}\r\n\r\nconst resetCallback = (result, error) => {\r\n    if (result !== null) {\r\n        $(\"#pfStatus\").html(\"Password reset email sent to your email address.\");\r\n        setTimeout(() => {setDialogClose()}, 1500)\r\n    } else if (error !== null) {\r\n        $(\"#pfStatus\").html(PlayFab.GenerateErrorReport(error));\r\n        setTimeout(() => {$(\"#pfStatus\").empty()}, 3500);\r\n    }\r\n}\r\n\r\nfunction registerAcct(){\r\n    const registerRequest = {\r\n        TitleId: PlayFab.settings.titleId,\r\n        Email : $(\"#email\").val(),\r\n        Password : $(\"#password\").val(),\r\n        RequireBothUsernameAndEmail : false,\r\n    };\r\n    PlayFabClientSDK.RegisterPlayFabUser(registerRequest, registerCallback);\r\n}\r\n\r\nconst registerCallback = function (result, error) {\r\n    if (result !== null) {\r\n        loginAcct();\r\n    } else if (error !== null) {\r\n        $(\"#pfStatus\").html(PlayFab.GenerateErrorReport(error));\r\n        setTimeout(() => {$(\"#pfStatus\").empty()}, 3500);\r\n    }\r\n}\r\n\r\nfunction loginAcct(){\r\n    const loginRequest = {\r\n        TitleId: PlayFab.settings.titleId,\r\n        Email : $(\"#email\").val(),\r\n        Password : $(\"#password\").val(),\r\n    };\r\n    PlayFabClientSDK.LoginWithEmailAddress(loginRequest, LoginCallback);\r\n}\r\n\r\nconst LoginCallback = function (result, error) {\r\n    if (result !== null) {\r\n        sessionID = result.data.SessionTicket;\r\n        $(\"#pfLoginRegister\").hide();\r\n        $(\"#pfImportExport\").show();\r\n        getSaveFromCloud();\r\n    } else if (error !== null) {\r\n        $(\"#pfStatus\").html(PlayFab.GenerateErrorReport(error));\r\n        setTimeout(() => {$(\"#pfStatus\").empty()}, 3500);\r\n    }\r\n}\r\n\r\nfunction saveToCloud() {\r\n    $(\"#pfStatusSave\").html(\"Saving...\");\r\n    forceSave();\r\n    const requestData = {\r\n        TitleId : PlayFab.settings.titleId,\r\n        Data : {\r\n            \"savestring\" : createSaveExport(),\r\n        }\r\n    }\r\n    PlayFab.ClientApi.UpdateUserData(requestData,saveCallback);\r\n};\r\n\r\nfunction saveCallback(result,error) {\r\n    if (result !== null) {\r\n        getSaveFromCloud();\r\n    }\r\n    if (error !== null) {\r\n        $(\"#pfStatusSave\").html(PlayFab.GenerateErrorReport(error));\r\n    }\r\n}\r\n\r\nfunction loadFromCloud() {\r\n    getSaveFromCloud();\r\n    if (saveFile) {\r\n        localStorage.setItem('ffgs1', JSON.stringify(saveFile));\r\n        location.replace('/');\r\n    }\r\n}\r\n\r\nfunction getSaveFromCloud() {\r\n    const requestData = {\r\n        Keys : [\"savestring\"],\r\n    }\r\n    PlayFab.ClientApi.GetUserData(requestData,loadCallback);\r\n};\r\n\r\nfunction loadCallback(result,error) {\r\n    if (error !== null) {\r\n        $(\"#pfStatusSave\").html(PlayFab.GenerateErrorReport(error));        \r\n    }\r\n    if (result) {\r\n        if (result.data.Data !== null) {\r\n            saveFile = JSON.parse(JSON.parse(pako.ungzip(atob(result.data.Data.savestring.Value),{ to: 'string' })));\r\n            const date = saveFile[\"saveTime\"];\r\n            const dateString = new Date(date).toString();\r\n            $(\"#pfStatusSave\").html(\"Last save:</br>\"+dateString);\r\n        }\r\n        else {\r\n            saveFile = null;\r\n            $(\"#pfStatusSave\").text(\"No save uploaded.\");\r\n        }\r\n    }\r\n}"],"file":"playfab.js"}