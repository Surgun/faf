{"version":3,"sources":["../../src/js/blacksmith.js"],"names":["$smithBuilding","$","$smithInvSlots","$smithOriginal","$smithImproved","$smithMax","$smithConfirm","$smithCanImproveDiv","$smithCantImproveDiv","$smithNoSelectionDiv","$smithHeroSlots","bloopSmith","smithStage","lvl","heroView","createSave","save","loadSave","undefined","addSmith","containerID","location","item","Inventory","containerToItem","HeroManager","getContainerID","sharp","maxSharp","Notifications","cantSmithMax","refreshSmithStage","getSmithCost","amt","Math","floor","goldValue","miscLoadedValues","smithChance","material","smith","params","ResourceManager","materialAvailable","gold","cantAffordSmithGold","resType","resAmt","cantAffordSmithMaterials","idToMaterial","name","deductMoney","addMaterial","smithSuccess","refreshInventoryPlaces","canImprove","addLevel","refreshSmithInventory","initiateForgeBldg","show","empty","invItems","nonblank","filter","i","recipeType","length","addClass","html","appendTo","forEach","append","itemCardSmith","heroes","hero","owned","heroButton","data","id","head","smithBackButton","idToHero","getEquipSlots","gear","isTrinket","hasContainer","hide","itemStageCardSmith","improveText","improveCost","attr","miscIcons","formatToUnits","img","locationText","itemdiv","rarity","picName","itemLevel","materialIcon","itemProps","Object","entries","itemStat","stat","val","slot","upgrade","itemName","picNamePlus","itemMaterial","d","document","on","e","preventDefault","parseInt","target","destroyTooltip","heroID","currentTarget"],"mappings":"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","sourcesContent":["\"use strict\";\r\n\r\nconst $smithBuilding = $(\"#smithBuilding\");\r\nconst $smithInvSlots = $(\"#smithInvSlots\");\r\nconst $smithOriginal = $(\"#smithOriginal\");\r\nconst $smithImproved = $(\"#smithImproved\");\r\nconst $smithMax = $(\"#smithMax\");\r\nconst $smithConfirm = $(\"#smithConfirm\");\r\nconst $smithCanImproveDiv = $(\"#smithCanImproveDiv\");\r\nconst $smithCantImproveDiv = $(\"#smithCantImproveDiv\");\r\nconst $smithNoSelectionDiv = $(\"#smithNoSelectionDiv\");\r\nconst $smithHeroSlots= $(\"#smithHeroSlots\");\r\n\r\nconst bloopSmith = {\r\n    smithStage : null,\r\n    lvl : 1,\r\n    heroView : null,\r\n    createSave() {\r\n        const save = {};\r\n        save.lvl = this.lvl;\r\n        return save;\r\n    },\r\n    loadSave(save) {\r\n        if (save.lvl !== undefined) this.lvl = save.lvl;\r\n    },\r\n    addSmith(containerID,location) {\r\n        const item = (location === \"inventory\") ? Inventory.containerToItem(containerID) : HeroManager.getContainerID(containerID);\r\n        if (item.sharp >= this.maxSharp()) return Notifications.cantSmithMax();\r\n        this.smithStage = item;\r\n        refreshSmithStage();\r\n    },\r\n    getSmithCost() {\r\n        const item = bloopSmith.smithStage;\r\n        const amt = [25,50,75,100,150,200,250,300,400,500];\r\n        return {\"gold\":Math.floor(item.goldValue()*miscLoadedValues.smithChance[item.sharp]),\"resType\":item.material(),\"resAmt\":amt[item.sharp]};\r\n    },\r\n    smith() {\r\n        if (this.smithStage === null) return;\r\n        const params = this.getSmithCost();\r\n        if (ResourceManager.materialAvailable(\"M001\") < params.gold) {\r\n            Notifications.cantAffordSmithGold();\r\n            return;\r\n        }\r\n        if (ResourceManager.materialAvailable(params.resType) < params.resAmt) {\r\n            Notifications.cantAffordSmithMaterials(ResourceManager.idToMaterial(params.resType).name, params.resAmt-ResourceManager.materialAvailable(params.resType));\r\n            return;\r\n        }\r\n        ResourceManager.deductMoney(params.gold);\r\n        ResourceManager.addMaterial(params.resType,-params.resAmt);\r\n        this.smithStage.sharp += 1;\r\n        Notifications.smithSuccess(this.smithStage.name);\r\n        refreshInventoryPlaces();\r\n        refreshSmithStage();\r\n    },\r\n    maxSharp() {\r\n        if (this.lvl === 1) return 3;\r\n        if (this.lvl === 2) return 6;\r\n        return 10;\r\n    },\r\n    canImprove() {\r\n        return this.smithStage.sharp < this.maxSharp();\r\n    },\r\n    addLevel() {\r\n        this.lvl += 1;\r\n        refreshSmithInventory();\r\n        refreshSmithStage();\r\n    }\r\n}\r\nfunction initiateForgeBldg() {\r\n    $smithBuilding.show();\r\n    bloopSmith.smithStage = null;\r\n    bloopSmith.heroView = null;\r\n    refreshSmithInventory();\r\n    refreshSmithStage();\r\n}\r\n\r\nfunction refreshSmithInventory() {\r\n    $smithInvSlots.empty();\r\n    $smithHeroSlots.empty();\r\n    const invItems = Inventory.nonblank().filter(i=>i.sharp < bloopSmith.maxSharp() && i.item.recipeType === \"normal\");\r\n    if (invItems.length === 0) {\r\n        $(\"<div/>\").addClass(\"smithInvBlank\").html(\"No Items in Inventory\").appendTo($smithInvSlots);\r\n    }\r\n    else {\r\n        invItems.forEach(item => {\r\n            $smithInvSlots.append(itemCardSmith(item,\"inventory\",\"\"));\r\n        });\r\n    }\r\n    if (bloopSmith.heroView === null) {\r\n        HeroManager.heroes.filter(hero=>hero.owned).forEach(hero => {\r\n            const heroButton = $(\"<div/>\").addClass(\"smithHeroButton\").data(\"heroID\",hero.id).html(`${hero.head}`).appendTo($smithHeroSlots);\r\n                $(\"<div/>\").addClass('smithHeroButtonName').html(`${hero.name}`).appendTo(heroButton);\r\n        })\r\n    }\r\n    else {\r\n        const smithBackButton = $(\"<div/>\").addClass(\"smithActionsContainer\").appendTo($smithHeroSlots)\r\n            $(\"<div/>\").addClass(\"smithHeroButton smithHeroBackButton\").data(\"heroID\",null).html(`<i class=\"fas fa-arrow-left\"></i> Select a different Hero`).appendTo(smithBackButton);\r\n        const hero = HeroManager.idToHero(bloopSmith.heroView);\r\n        hero.getEquipSlots(true).forEach(gear => {\r\n            if (gear.isTrinket()) return;\r\n            $smithHeroSlots.append(itemCardSmith(gear,\"gear\",`Equipped to ${hero.name}`));\r\n        })\r\n    }\r\n};\r\n\r\nfunction refreshSmithStage() {\r\n    if (bloopSmith.smithStage !== null && !Inventory.hasContainer(bloopSmith.smithStage.containerID) && !HeroManager.hasContainer(bloopSmith.smithStage.containerID)) {\r\n        bloopSmith.smithStage = null;\r\n    }\r\n    if (bloopSmith.smithStage === null) {\r\n        $smithNoSelectionDiv.show();\r\n        $smithCanImproveDiv.hide();\r\n        $smithCantImproveDiv.hide();\r\n        return;\r\n    };\r\n    if (!bloopSmith.canImprove()) {\r\n        $smithCanImproveDiv.hide();\r\n        $smithCantImproveDiv.show();\r\n        $smithNoSelectionDiv.hide();\r\n        $smithMax.html(itemStageCardSmith(bloopSmith.smithStage,false));\r\n        return;\r\n    }\r\n    $smithCanImproveDiv.show();\r\n    $smithCantImproveDiv.hide();\r\n    $smithNoSelectionDiv.hide();\r\n    $smithOriginal.html(itemStageCardSmith(bloopSmith.smithStage,false));\r\n    $smithImproved.html(itemStageCardSmith(bloopSmith.smithStage,true));\r\n    const params = bloopSmith.getSmithCost()\r\n    const improveText = $(\"<div/>\").addClass(\"improveText\").html(`Improve for`);\r\n    const improveCost = $(\"<div/>\").addClass(\"improveCostContainer\");\r\n        $(\"<div/>\").addClass(\"improveCost tooltip\").attr({\"data-tooltip\": \"gold_value\", \"data-tooltip-value\": params.gold}).html(`${miscIcons.gold} ${formatToUnits(params.gold,2)}`).appendTo(improveCost);\r\n        $(\"<div/>\").addClass(\"improveCost tooltip\").attr({\"data-tooltip\":\"material_desc\",\"data-tooltip-value\": params.resType}).html(`${ResourceManager.idToMaterial(params.resType).img} ${params.resAmt}`).appendTo(improveCost);\r\n    $smithConfirm.empty().append(improveText,improveCost);\r\n}\r\n\r\nfunction itemCardSmith(item,location,locationText) {\r\n    const itemdiv = $(\"<div/>\").addClass(\"smithItem\").addClass(\"R\"+item.rarity);\r\n        $(\"<div/>\").addClass(\"smithItemName itemName\").html(item.picName()).appendTo(itemdiv);\r\n        $(\"<div/>\").addClass(\"smithItemLevel\").html(item.itemLevel()).appendTo(itemdiv);\r\n        $(\"<div/>\").addClass(\"smithItemMaterial tooltip\").attr({\"data-tooltip\":\"material_desc\",\"data-tooltip-value\":item.material()}).html(ResourceManager.materialIcon(item.material())).appendTo(itemdiv);\r\n        const itemProps = $(\"<div/>\").addClass(\"smithProps\").appendTo(itemdiv);\r\n        for (const [stat, val] of Object.entries(item.itemStat(false))) {\r\n            if (val === 0) continue;\r\n            $(\"<div/>\").addClass(\"invPropStat tooltip\").attr(\"data-tooltip\", stat).html(`${miscIcons[stat]} ${val}`).appendTo(itemProps);\r\n        }\r\n        if (locationText !== \"\") $(\"<div/>\").addClass(\"smithItemLocation\").html(locationText).appendTo(itemdiv);\r\n        $(\"<div/>\").addClass(\"smithStage\").attr(\"containerID\",item.containerID).data(\"location\",location).html(\"Smith\").appendTo(itemdiv);\r\n    return itemdiv;\r\n}\r\n\r\nfunction itemStageCardSmith(slot,upgrade) {\r\n    if (slot === null) return;\r\n    const itemdiv = $(\"<div/>\").addClass(\"smithItem\").addClass(\"R\"+slot.rarity);\r\n    const itemName = $(\"<div/>\").addClass(\"smithItemName itemName\");\r\n    if (upgrade) itemName.html(slot.picNamePlus());\r\n    else itemName.html(slot.picName());\r\n    const itemLevel = $(\"<div/>\").addClass(\"smithItemLevel\").html(slot.itemLevel());\r\n    const itemMaterial = $(\"<div/>\").addClass(\"smithItemMaterial tooltip\").attr({\"data-tooltip\":\"material_desc\",\"data-tooltip-value\":slot.material()}).html(ResourceManager.materialIcon(slot.material()));\r\n    const itemProps = $(\"<div/>\").addClass(\"smithProps\");\r\n    const d = $(\"<div/>\").addClass(\"invProp\").appendTo(itemProps);\r\n    for (const [stat, val] of Object.entries(slot.itemStat(upgrade))) {\r\n        if (val === 0) continue;\r\n        $(\"<div/>\").addClass(\"invPropStat tooltip\").attr(\"data-tooltip\", stat).html(`${miscIcons[stat]} ${val}`).appendTo(d);\r\n    }\r\n    return itemdiv.append(itemName,itemLevel,itemMaterial,itemProps);\r\n}\r\n\r\n$(document).on(\"click\",\".smithStage\",(e) => {\r\n    e.preventDefault();\r\n    const containerID = parseInt($(e.target).attr(\"containerID\"));\r\n    const location = $(e.target).data(\"location\");\r\n    bloopSmith.addSmith(containerID,location);\r\n    refreshSmithStage();\r\n});\r\n\r\n$(document).on(\"click\",\"#smithConfirm\",(e) => {\r\n    e.preventDefault();\r\n    destroyTooltip();\r\n    bloopSmith.smith();\r\n});\r\n\r\n$(document).on(\"click\",\".smithHeroButton\",(e) => {\r\n    const heroID = $(e.currentTarget).data(\"heroID\");\r\n    bloopSmith.heroView = heroID;\r\n    refreshSmithInventory();\r\n});"],"file":"blacksmith.js"}