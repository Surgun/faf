{"version":3,"sources":["../../src/js/bank.js"],"names":["$bankInvSlots","$","$bankBankSlots","$bankBuilding","BankManager","slots","lvl","createSave","save","forEach","slot","push","loadSave","item","container","itemContainer","id","rarity","undefined","maxSlots","full","length","containerToItem","containerID","find","s","addFromInventory","Inventory","removeContainerFromInventory","addContainer","removeContainer","filter","c","refreshBankBank","sortBank","sort","a","b","inventorySort","removeFromBank","addToInventory","addLevel","refreshBankInventory","initiateBankBldg","show","empty","d1","addClass","d2","html","nonblank","invMax","d3","attr","append","itemCard","inBank","itemdiv","itemName","picName","itemLevel","recipeType","hide","itemProps","Object","entries","itemStat","stat","val","miscIcons","appendTo","locationButton","document","on","e","preventDefault","parseInt","target","sortInventory"],"mappings":"AAAA;;;;;;;;;;AAEA,IAAMA,aAAa,GAAGC,CAAC,CAAC,eAAD,CAAvB;AACA,IAAMC,cAAc,GAAGD,CAAC,CAAC,gBAAD,CAAxB;AACA,IAAME,aAAa,GAAGF,CAAC,CAAC,eAAD,CAAvB;AAEA,IAAMG,WAAW,GAAG;AAChBC,EAAAA,KAAK,EAAG,EADQ;AAEhBC,EAAAA,GAAG,EAAG,CAFU;AAGhBC,EAAAA,UAHgB,wBAGH;AACT,QAAMC,IAAI,GAAG,EAAb;AACAA,IAAAA,IAAI,CAACF,GAAL,GAAW,KAAKA,GAAhB;AACAE,IAAAA,IAAI,CAACH,KAAL,GAAa,EAAb;AACA,SAAKA,KAAL,CAAWI,OAAX,CAAmB,UAAAC,IAAI,EAAI;AACvBF,MAAAA,IAAI,CAACH,KAAL,CAAWM,IAAX,CAAgBD,IAAI,CAACH,UAAL,EAAhB;AACH,KAFD;AAGA,WAAOC,IAAP;AACH,GAXe;AAYhBI,EAAAA,QAZgB,oBAYPJ,IAZO,EAYD;AAAA;;AACXA,IAAAA,IAAI,CAACH,KAAL,CAAWI,OAAX,CAAmB,UAAAI,IAAI,EAAI;AACvB,UAAMC,SAAS,GAAG,IAAIC,aAAJ,CAAkBF,IAAI,CAACG,EAAvB,EAA0BH,IAAI,CAACI,MAA/B,CAAlB;AACAH,MAAAA,SAAS,CAACF,QAAV,CAAmBC,IAAnB;;AACA,MAAA,KAAI,CAACR,KAAL,CAAWM,IAAX,CAAgBG,SAAhB;AACH,KAJD;AAKA,QAAIN,IAAI,CAACF,GAAL,KAAaY,SAAjB,EAA4B,KAAKZ,GAAL,GAAWE,IAAI,CAACF,GAAhB;AAC/B,GAnBe;AAoBhBa,EAAAA,QApBgB,sBAoBL;AACP,WAAO,KAAKb,GAAL,GAAS,CAAT,GAAW,EAAlB;AACH,GAtBe;AAuBhBc,EAAAA,IAvBgB,kBAuBT;AACH,WAAO,KAAKf,KAAL,CAAWgB,MAAX,KAAsB,KAAKF,QAAL,EAA7B;AACH,GAzBe;AA0BhBG,EAAAA,eA1BgB,2BA0BAC,WA1BA,EA0Ba;AACzB,WAAO,KAAKlB,KAAL,CAAWmB,IAAX,CAAgB,UAAAC,CAAC;AAAA,aAAEA,CAAC,CAACF,WAAF,KAAkBA,WAApB;AAAA,KAAjB,CAAP;AACH,GA5Be;AA6BhBG,EAAAA,gBA7BgB,4BA6BCH,WA7BD,EA6Bc;AAC1B,QAAI,KAAKH,IAAL,EAAJ,EAAiB;AACjB,QAAMN,SAAS,GAAGa,SAAS,CAACL,eAAV,CAA0BC,WAA1B,CAAlB;AACAI,IAAAA,SAAS,CAACC,4BAAV,CAAuCL,WAAvC;AACA,SAAKM,YAAL,CAAkBf,SAAlB;AACH,GAlCe;AAmChBgB,EAAAA,eAnCgB,2BAmCAP,WAnCA,EAmCa;AACzB,SAAKlB,KAAL,GAAa,KAAKA,KAAL,CAAW0B,MAAX,CAAkB,UAAAC,CAAC;AAAA,aAAEA,CAAC,CAACT,WAAF,KAAkBA,WAApB;AAAA,KAAnB,CAAb;AACAU,IAAAA,eAAe;AAClB,GAtCe;AAuChBC,EAAAA,QAvCgB,sBAuCL;AACP,SAAK7B,KAAL,CAAW8B,IAAX,CAAgB,UAACC,CAAD,EAAGC,CAAH;AAAA,aAASC,aAAa,CAACF,CAAD,EAAGC,CAAH,CAAtB;AAAA,KAAhB;AACAJ,IAAAA,eAAe;AAClB,GA1Ce;AA2ChBJ,EAAAA,YA3CgB,wBA2CHf,SA3CG,EA2CQ;AACpB,SAAKT,KAAL,CAAWM,IAAX,CAAgBG,SAAhB;AACAmB,IAAAA,eAAe;AAClB,GA9Ce;AA+ChBM,EAAAA,cA/CgB,0BA+CDhB,WA/CC,EA+CY;AACxB,QAAII,SAAS,CAACP,IAAV,EAAJ,EAAsB;AACtB,QAAMN,SAAS,GAAG,KAAKQ,eAAL,CAAqBC,WAArB,CAAlB;AACA,SAAKO,eAAL,CAAqBP,WAArB;AACAI,IAAAA,SAAS,CAACa,cAAV,CAAyB1B,SAAzB;AACH,GApDe;AAqDhB2B,EAAAA,QArDgB,sBAqDL;AACP,SAAKnC,GAAL,IAAY,CAAZ;AACA2B,IAAAA,eAAe;AACfS,IAAAA,oBAAoB;AACvB;AAzDe,CAApB;;AA4DA,SAASC,gBAAT,GAA4B;AACxBxC,EAAAA,aAAa,CAACyC,IAAd;AACAX,EAAAA,eAAe;AACfS,EAAAA,oBAAoB;AACvB;;AAED,SAASA,oBAAT,GAAgC;AAC5B1C,EAAAA,aAAa,CAAC6C,KAAd;AACA,MAAMC,EAAE,GAAG7C,CAAC,CAAC,QAAD,CAAD,CAAY8C,QAAZ,CAAqB,sBAArB,CAAX;AACA,MAAMC,EAAE,GAAG/C,CAAC,CAAC,QAAD,CAAD,CAAY8C,QAAZ,CAAqB,aAArB,EAAoCE,IAApC,sBAAuDtB,SAAS,CAACuB,QAAV,GAAqB7B,MAA5E,cAAsFM,SAAS,CAACwB,MAAhG,OAAX;AACA,MAAMC,EAAE,GAAGnD,CAAC,CAAC,QAAD,CAAD,CAAYoD,IAAZ,CAAiB,IAAjB,EAAsB,mBAAtB,EAA2CN,QAA3C,CAAoD,gCAApD,EAAsFE,IAAtF,CAA2F,gBAA3F,CAAX;AACAH,EAAAA,EAAE,CAACQ,MAAH,CAAUN,EAAV,EAAaI,EAAb;AACApD,EAAAA,aAAa,CAACsD,MAAd,CAAqBR,EAArB;AACAnB,EAAAA,SAAS,CAACuB,QAAV,GAAqBzC,OAArB,CAA6B,UAAAI,IAAI,EAAI;AACjCb,IAAAA,aAAa,CAACsD,MAAd,CAAqBC,QAAQ,CAAC1C,IAAD,EAAM,KAAN,CAA7B;AACH,GAFD;AAGH;;AAED,SAASoB,eAAT,GAA2B;AACvB/B,EAAAA,cAAc,CAAC2C,KAAf;AACA,MAAMC,EAAE,GAAG7C,CAAC,CAAC,QAAD,CAAD,CAAY8C,QAAZ,CAAqB,uBAArB,CAAX;AACA,MAAMC,EAAE,GAAG/C,CAAC,CAAC,QAAD,CAAD,CAAY8C,QAAZ,CAAqB,cAArB,EAAqCE,IAArC,iBAAmD7C,WAAW,CAACC,KAAZ,CAAkBgB,MAArE,cAA+EjB,WAAW,CAACe,QAAZ,EAA/E,OAAX;AACA,MAAMiC,EAAE,GAAGnD,CAAC,CAAC,QAAD,CAAD,CAAYoD,IAAZ,CAAiB,IAAjB,EAAsB,UAAtB,EAAkCN,QAAlC,CAA2C,uBAA3C,EAAoEE,IAApE,CAAyE,WAAzE,CAAX;AACAH,EAAAA,EAAE,CAACQ,MAAH,CAAUN,EAAV,EAAaI,EAAb;AACAlD,EAAAA,cAAc,CAACoD,MAAf,CAAsBR,EAAtB;AACA1C,EAAAA,WAAW,CAACC,KAAZ,CAAkBI,OAAlB,CAA0B,UAAAI,IAAI,EAAI;AAC9BX,IAAAA,cAAc,CAACoD,MAAf,CAAsBC,QAAQ,CAAC1C,IAAD,EAAM,IAAN,CAA9B;AACH,GAFD;AAGH;;AAED,SAAS0C,QAAT,CAAkB1C,IAAlB,EAAuB2C,MAAvB,EAA+B;AAC3B,MAAMC,OAAO,GAAGxD,CAAC,CAAC,QAAD,CAAD,CAAY8C,QAAZ,CAAqB,UAArB,EAAiCA,QAAjC,CAA0C,MAAIlC,IAAI,CAACI,MAAnD,CAAhB;AACA,MAAMyC,QAAQ,GAAGzD,CAAC,CAAC,QAAD,CAAD,CAAY8C,QAAZ,CAAqB,uBAArB,EAA8CE,IAA9C,CAAmDpC,IAAI,CAAC8C,OAAL,EAAnD,CAAjB;AACA,MAAMC,SAAS,GAAG3D,CAAC,CAAC,QAAD,CAAD,CAAY8C,QAAZ,CAAqB,eAArB,EAAsCE,IAAtC,CAA2CpC,IAAI,CAAC+C,SAAL,EAA3C,CAAlB;AACA,MAAI/C,IAAI,CAACA,IAAL,CAAUgD,UAAV,KAAyB,UAA7B,EAAyCD,SAAS,CAACE,IAAV;AACzC,MAAMC,SAAS,GAAG9D,CAAC,CAAC,QAAD,CAAD,CAAY8C,QAAZ,CAAqB,WAArB,CAAlB;;AACA,qCAA0BiB,MAAM,CAACC,OAAP,CAAepD,IAAI,CAACqD,QAAL,CAAc,KAAd,CAAf,CAA1B,qCAAgE;AAAA;AAAA,QAApDC,IAAoD;AAAA,QAA9CC,GAA8C;;AAC5D,QAAIA,GAAG,KAAK,CAAZ,EAAe;AACfnE,IAAAA,CAAC,CAAC,QAAD,CAAD,CAAY8C,QAAZ,CAAqB,qBAArB,EAA4CM,IAA5C,CAAiD,cAAjD,EAAgEc,IAAhE,EAAsElB,IAAtE,WAA8EoB,SAAS,CAACF,IAAD,CAAvF,cAAiGC,GAAjG,GAAwGE,QAAxG,CAAiHP,SAAjH;AACH;;AACD,MAAMQ,cAAc,GAAGtE,CAAC,CAAC,QAAD,CAAD,CAAYoD,IAAZ,CAAiB,aAAjB,EAA+BxC,IAAI,CAACU,WAApC,CAAvB;AACA,MAAIiC,MAAJ,EAAYe,cAAc,CAACxB,QAAf,CAAwB,UAAxB,EAAoCE,IAApC,CAAyC,MAAzC,EAAZ,KACKsB,cAAc,CAACxB,QAAf,CAAwB,UAAxB,EAAoCE,IAApC,CAAyC,MAAzC;AACL,SAAOQ,OAAO,CAACH,MAAR,CAAeI,QAAf,EAAwBE,SAAxB,EAAkCG,SAAlC,EAA4CQ,cAA5C,CAAP;AACH;;AAEDtE,CAAC,CAACuE,QAAD,CAAD,CAAYC,EAAZ,CAAe,OAAf,EAAuB,WAAvB,EAAmC,UAACC,CAAD,EAAO;AACtCA,EAAAA,CAAC,CAACC,cAAF;AACA,MAAMpD,WAAW,GAAGqD,QAAQ,CAAC3E,CAAC,CAACyE,CAAC,CAACG,MAAH,CAAD,CAAYxB,IAAZ,CAAiB,aAAjB,CAAD,CAA5B;AACAjD,EAAAA,WAAW,CAACmC,cAAZ,CAA2BhB,WAA3B;AACH,CAJD;AAMAtB,CAAC,CAACuE,QAAD,CAAD,CAAYC,EAAZ,CAAe,OAAf,EAAuB,WAAvB,EAAmC,UAACC,CAAD,EAAO;AACtCA,EAAAA,CAAC,CAACC,cAAF;AACA,MAAMpD,WAAW,GAAGqD,QAAQ,CAAC3E,CAAC,CAACyE,CAAC,CAACG,MAAH,CAAD,CAAYxB,IAAZ,CAAiB,aAAjB,CAAD,CAA5B;AACAjD,EAAAA,WAAW,CAACsB,gBAAZ,CAA6BH,WAA7B;AACH,CAJD;AAMAtB,CAAC,CAACuE,QAAD,CAAD,CAAYC,EAAZ,CAAe,OAAf,EAAuB,WAAvB,EAAmC,UAACC,CAAD,EAAO;AACtCA,EAAAA,CAAC,CAACC,cAAF;AACAvE,EAAAA,WAAW,CAAC8B,QAAZ;AACH,CAHD;AAKAjC,CAAC,CAACuE,QAAD,CAAD,CAAYC,EAAZ,CAAe,OAAf,EAAuB,oBAAvB,EAA4C,UAACC,CAAD,EAAO;AAC/CA,EAAAA,CAAC,CAACC,cAAF;AACAhD,EAAAA,SAAS,CAACmD,aAAV;AACH,CAHD","sourcesContent":["\"use strict\";\r\n\r\nconst $bankInvSlots = $(\"#bankInvSlots\");\r\nconst $bankBankSlots = $(\"#bankBankSlots\");\r\nconst $bankBuilding = $(\"#bankBuilding\");\r\n\r\nconst BankManager = {\r\n    slots : [],\r\n    lvl : 1,\r\n    createSave() {\r\n        const save = {};\r\n        save.lvl = this.lvl;\r\n        save.slots = [];\r\n        this.slots.forEach(slot => {\r\n            save.slots.push(slot.createSave());\r\n        });\r\n        return save;\r\n    },\r\n    loadSave(save) {\r\n        save.slots.forEach(item => {\r\n            const container = new itemContainer(item.id,item.rarity);\r\n            container.loadSave(item);\r\n            this.slots.push(container);\r\n        });\r\n        if (save.lvl !== undefined) this.lvl = save.lvl;\r\n    },\r\n    maxSlots() {\r\n        return this.lvl*5+10;\r\n    },\r\n    full() {\r\n        return this.slots.length === this.maxSlots();\r\n    },\r\n    containerToItem(containerID) {\r\n        return this.slots.find(s=>s.containerID === containerID)\r\n    },\r\n    addFromInventory(containerID) {\r\n        if (this.full()) return;\r\n        const container = Inventory.containerToItem(containerID);\r\n        Inventory.removeContainerFromInventory(containerID);\r\n        this.addContainer(container);\r\n    },\r\n    removeContainer(containerID) {\r\n        this.slots = this.slots.filter(c=>c.containerID !== containerID);\r\n        refreshBankBank();\r\n    },\r\n    sortBank() {\r\n        this.slots.sort((a,b) => inventorySort(a,b));\r\n        refreshBankBank()\r\n    },\r\n    addContainer(container) {\r\n        this.slots.push(container);\r\n        refreshBankBank();\r\n    },\r\n    removeFromBank(containerID) {\r\n        if (Inventory.full()) return;\r\n        const container = this.containerToItem(containerID);\r\n        this.removeContainer(containerID);\r\n        Inventory.addToInventory(container);\r\n    },\r\n    addLevel() {\r\n        this.lvl += 1;\r\n        refreshBankBank();\r\n        refreshBankInventory();\r\n    }\r\n}\r\n\r\nfunction initiateBankBldg() {\r\n    $bankBuilding.show();\r\n    refreshBankBank();\r\n    refreshBankInventory();\r\n}\r\n\r\nfunction refreshBankInventory() {\r\n    $bankInvSlots.empty();\r\n    const d1 = $(\"<div/>\").addClass(\"bankInvHeadContainer\");\r\n    const d2 = $(\"<div/>\").addClass(\"bankInvHead\").html(`Inventory (${Inventory.nonblank().length}/${Inventory.invMax})` );\r\n    const d3 = $(\"<div/>\").attr(\"id\",\"sortInventoryBank\").addClass(\"sortInventoryBank actionButton\").html(\"Sort Inventory\");\r\n    d1.append(d2,d3);\r\n    $bankInvSlots.append(d1);\r\n    Inventory.nonblank().forEach(item => {\r\n        $bankInvSlots.append(itemCard(item,false));\r\n    });\r\n}\r\n\r\nfunction refreshBankBank() {\r\n    $bankBankSlots.empty();\r\n    const d1 = $(\"<div/>\").addClass(\"bankBankHeadContainer\");\r\n    const d2 = $(\"<div/>\").addClass(\"bankBankHead\").html(`Bank (${BankManager.slots.length}/${BankManager.maxSlots()})` );\r\n    const d3 = $(\"<div/>\").attr(\"id\",\"sortBank\").addClass(\"sortBank actionButton\").html(\"Sort Bank\");\r\n    d1.append(d2,d3);\r\n    $bankBankSlots.append(d1);\r\n    BankManager.slots.forEach(item => {\r\n        $bankBankSlots.append(itemCard(item,true));\r\n    });\r\n}\r\n\r\nfunction itemCard(item,inBank) {\r\n    const itemdiv = $(\"<div/>\").addClass(\"bankItem\").addClass(\"R\"+item.rarity);\r\n    const itemName = $(\"<div/>\").addClass(\"bankItemName itemName\").html(item.picName());\r\n    const itemLevel = $(\"<div/>\").addClass(\"bankItemLevel\").html(item.itemLevel());\r\n    if (item.item.recipeType === \"building\") itemLevel.hide();\r\n    const itemProps = $(\"<div/>\").addClass(\"bankProps\");\r\n    for (const [stat, val] of Object.entries(item.itemStat(false))) {\r\n        if (val === 0) continue;\r\n        $(\"<div/>\").addClass(\"invPropStat tooltip\").attr(\"data-tooltip\",stat).html(`${miscIcons[stat]} ${val}`).appendTo(itemProps);\r\n    }\r\n    const locationButton = $(\"<div/>\").attr(\"containerID\",item.containerID);\r\n    if (inBank) locationButton.addClass('bankTake').html(\"Take\");\r\n    else locationButton.addClass('bankStow').html(\"Stow\");\r\n    return itemdiv.append(itemName,itemLevel,itemProps,locationButton);\r\n}\r\n\r\n$(document).on(\"click\",\".bankTake\",(e) => {\r\n    e.preventDefault();\r\n    const containerID = parseInt($(e.target).attr(\"containerID\"));\r\n    BankManager.removeFromBank(containerID);\r\n});\r\n\r\n$(document).on(\"click\",\".bankStow\",(e) => {\r\n    e.preventDefault();\r\n    const containerID = parseInt($(e.target).attr(\"containerID\"));\r\n    BankManager.addFromInventory(containerID);\r\n});\r\n\r\n$(document).on(\"click\",\"#sortBank\",(e) => {\r\n    e.preventDefault();\r\n    BankManager.sortBank();\r\n});\r\n\r\n$(document).on(\"click\",\"#sortInventoryBank\",(e) => {\r\n    e.preventDefault();\r\n    Inventory.sortInventory();\r\n});"],"file":"bank.js"}