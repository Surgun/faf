{"version":3,"sources":["../../src/js/dungeons.js"],"names":["DungeonStatus","Object","freeze","EMPTY","ADVENTURING","COLLECT","TurnOrder","heroes","mobs","order","interlace","position","nextNotDead","dead","length","nextPosition","save","mob","splice","uniqueid","Area","props","assign","unlocked","dungeons","id","dungeon","push","some","d","status","find","party","AreaManager","areas","areaView","addArea","area","idToArea","areaID","a","createSave","forEach","loadSave","areaSave","unlockArea","unlock","addDungeon","Dungeon","mobIDs","mob1","mob2","undefined","mob3","mob4","maxFloor","floor","floorClear","lastParty","Party","heroID","mobSave","mobTemplate","MobManager","idToMob","Mob","lvl","difficulty","t","dungeonTime","dungeonWaitTime","refreshLater","CombatManager","buffTick","passiveCheck","every","m","nextFloor","isDead","previousFloor","DungeonManager","dungeonView","$","getCurrentID","css","nextTurn","refreshTurnOrder","initiateDungeonFloor","BattleLog","refresh","refreshBeatBar","h","inDungeon","hp","maxHP","clear","openTab","initializeSideBarDungeon","dungeonsTabClicked","type","dungeonComplete","Math","max","resetFloor","achievementStats","floorRecord","mobID","generateMob","reset","html","name","refreshSidebarDungeonMats","showDungeonReward","boss","event","formatToUnits","round","hero","enemy","amt","idAmt","speed","dungeonPaid","bossesBeat","partySize","dungeonByID","addTime","dungeonStatus","dungeonID","createDungeon","floorSkip","PartyCreator","lockParty","initializeParty","abandonCurrentDungeon","resetDungeon","abandonAllDungeons","bossCount","bossDung","filter"],"mappings":"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","sourcesContent":["\"use strict\";\nconst DungeonStatus = Object.freeze({EMPTY:0,ADVENTURING:1,COLLECT:2});\n\nclass TurnOrder {\n    constructor(heroes,mobs) {\n        this.heroes = heroes;\n        this.mobs = mobs;\n        this.order = interlace(heroes,mobs);\n        this.position = 0;\n        this.nextNotDead();\n    }\n    nextNotDead() {\n        while (this.order[this.position].dead()) this.position += 1;\n    }\n    getOrder() {\n        return this.order;\n    }\n    nextTurn() {\n        return this.order[this.position];\n    }\n    nextPosition() {\n        this.position += 1;\n        if (this.position === this.order.length) this.position = 0;\n        if (this.order[this.position].dead()) this.nextPosition();\n    }\n    createSave() {\n        const save = {};\n        save.position = this.position;\n        return save;\n    }\n    loadSave(save) {\n        this.position = save.position;\n    }\n    addMob(mob) {\n        this.order.splice(this.position+1,0,mob);\n    }\n    getCurrentID() {\n        return this.order[this.position].uniqueid;\n    }\n}\n\nclass Area {\n    constructor(props) {\n        Object.assign(this, props);\n        this.unlocked = false;\n        this.dungeons = [];\n    }\n    createSave() {\n        const save = {};\n        save.id = this.id;\n        save.unlocked = this.unlocked;\n        return save;\n    }\n    loadSave(save) {\n        this.unlocked = save.unlocked;\n    }\n    unlock() {\n        this.unlocked = true;\n    }\n    addDungeon(dungeon) {\n        this.dungeons.push(dungeon);\n    }\n    status() {\n        if (this.dungeons.some(d => d.status === DungeonStatus.COLLECT)) return DungeonStatus.COLLECT;\n        if (this.dungeons.some(d => d.status === DungeonStatus.ADVENTURING)) return DungeonStatus.ADVENTURING;\n        return DungeonStatus.EMPTY;\n    }\n    activeParty() {\n        const dungeon = this.dungeons.find(d => d.status === DungeonStatus.ADVENTURING);\n        return dungeon.party;\n    }\n    activeDungeonID() {\n        return this.dungeons.find(d => d.status === DungeonStatus.ADVENTURING || d.status === DungeonStatus.COLLECT).id;\n    }\n}\n\nconst AreaManager = {\n    areas : [],\n    areaView : null,\n    addArea(area) {\n        this.areas.push(area);\n    },\n    idToArea(areaID) {\n        return this.areas.find(a=>a.id === areaID);\n    },\n    createSave() {\n        const save = {};\n        save.areas = [];\n        this.areas.forEach(area => save.areas.push(area.createSave()));\n    },\n    loadSave(save) {\n        save.areas.forEach(areaSave => {\n            const area = this.idToArea(areaSave.id);\n            area.loadSave(areaSave);\n        });\n    },\n    unlockArea(areaID) {\n        const area = this.idToArea(areaID);\n        area.unlock();\n    },\n    addDungeon(dungeon) {\n        const area = this.idToArea(dungeon.area);\n        area.addDungeon(dungeon);\n    }\n}\n\nclass Dungeon {\n    constructor(props) {\n        Object.assign(this, props);\n        this.party = null;\n        this.mobs = [];\n        this.mobIDs = [];\n        this.mobIDs.push(this.mob1);\n        if (this.mob2 !== undefined) this.mobIDs.push(this.mob2);\n        if (this.mob3 !== undefined) this.mobIDs.push(this.mob3);\n        if (this.mob4 !== undefined) this.mobIDs.push(this.mob4);\n        this.maxFloor = 0;\n        this.floor = 0;\n        this.floorClear = 0;\n        this.order = null;\n        this.status = DungeonStatus.EMPTY;\n        this.lastParty = null;\n    }\n    createSave() {\n        const save = {};\n        save.id = this.id;\n        if (this.party !== null) save.party = this.party.createSave();\n        else save.party = null;\n        save.mobs = [];\n        this.mobs.forEach(mob => {\n            save.mobs.push(mob.createSave());\n        });\n        save.maxFloor = this.maxFloor;\n        save.floor = this.floor;\n        save.floorClear = this.floorClear;\n        if (this.order !== null) save.order = this.order.createSave();\n        else save.order = null;\n        save.status = this.status;\n        save.lastParty = this.lastParty;\n        return save;\n    }\n    loadSave(save) {\n        if (save.party !== null) this.party = new Party(save.party.heroID);\n        save.mobs.forEach(mobSave => {\n            const mobTemplate = MobManager.idToMob(mobSave.id);\n            const mob = new Mob(mobSave.lvl, mobTemplate, mobSave.difficulty);\n            mob.loadSave(mobSave);\n            this.mobs.push(mob);\n        });\n        if (save.maxFloor !== undefined) this.maxFloor = save.maxFloor;\n        if (save.floor !== undefined) this.floor = save.floor;\n        if (save.floorClear !== undefined) this.floorClear = save.floorClear;\n        if (save.order !== null) {\n            this.order = new TurnOrder(this.party.heroes,this.mobs);\n            this.order.loadSave(save.order);\n        }\n        this.status = save.status;\n        this.lastParty = save.lastParty;\n    }\n    addTime(t) {\n        //if there's enough time, grab the next guy and do some combat\n        if (this.status !== DungeonStatus.ADVENTURING) return;\n        this.dungeonTime += t;\n        const dungeonWaitTime = 750;\n        const refreshLater = this.dungeonTime >= 1500;\n        CombatManager.refreshLater = refreshLater;\n        while (this.dungeonTime >= dungeonWaitTime) {\n            this.dungeonTime -= dungeonWaitTime;\n            //take a turn\n            this.buffTick(\"onTurn\");\n            this.passiveCheck(\"onTurn\");\n            if (this.mobs.every(m=>m.dead())) {\n                this.nextFloor(refreshLater);\n                return;\n            }\n            else if (this.party.isDead()) {\n                this.previousFloor(refreshLater,true);\n                return;\n            }\n            if (!refreshLater && DungeonManager.dungeonView === this.id) $(`#beatbarFill${this.order.getCurrentID()}`).css('width',\"0%\");\n            CombatManager.nextTurn(this);\n            this.dungeonTime -= dungeonWaitTime;\n            if (!refreshLater && DungeonManager.dungeonView === this.id) refreshTurnOrder(this.id);\n            //we repeat this because we need it early for passives, and late for combat\n            if (this.mobs.every(m=>m.dead())) {\n                this.nextFloor(refreshLater);\n            }\n            else if (this.party.isDead()) {\n                this.previousFloor(refreshLater,true);\n            }\n        }\n        if (refreshLater) {\n            initiateDungeonFloor(this.id);\n            BattleLog.refresh();\n        }\n        if (DungeonManager.dungeonView === this.id) refreshBeatBar(this.order.getCurrentID(),this.dungeonTime);\n    }\n    initializeParty(party) {\n        this.party = party;\n        this.lastParty = party.heroID;\n    }\n    resetDungeon() {\n        if (this.status !== DungeonStatus.ADVENTURING && this.status !== DungeonStatus.COLLECT) return;\n        this.party.heroes.forEach(h=>{\n            h.inDungeon = false;\n            h.hp = h.maxHP()\n        });\n        if (DungeonManager.dungeonView === this.id) {\n            BattleLog.clear();\n            openTab(\"dungeonsTab\");\n        }\n        initializeSideBarDungeon();\n        dungeonsTabClicked();\n        this.status = DungeonStatus.EMPTY;\n        this.party = null;\n        this.order = null;\n        this.mobs = [];\n        this.floor = 0;\n        this.floorClear = 0;\n        return;\n    }\n    previousFloor(refreshLater) {\n        if (this.type === \"boss\") return this.dungeonComplete(previousFloor);\n        this.floor = Math.max(1,this.floor - 1);\n        this.resetFloor(refreshLater);\n    }\n    nextFloor(refreshLater, previousFloor) {\n        if (this.type === \"boss\") return this.dungeonComplete(previousFloor);   \n        this.floorClear = this.floor;\n        this.maxFloor = Math.max(this.maxFloor,this.floor);\n        this.floor += 1;        \n        achievementStats.floorRecord(this.id, this.maxFloor);\n        this.resetFloor(refreshLater);\n    }\n    resetFloor(refreshLater) {\n        this.mobs = [];\n        this.mobIDs.forEach(mobID => {\n            MobManager.generateMob(mobID,this);\n        });\n        this.party.reset();\n        this.order = new TurnOrder(this.party.heroes,this.mobs);\n        if (refreshLater || DungeonManager.dungeonView !== this.id) return;\n        initiateDungeonFloor(this.id);\n        $(\"#dsb\"+this.id).html(`${this.name} - ${this.floor}`);\n        refreshSidebarDungeonMats(this.id);\n    }\n    dungeonComplete() {\n        this.status = DungeonStatus.COLLECT;\n        dungeonsTabClicked();\n        if (DungeonManager.dungeonView === this.id) showDungeonReward(this.id);\n    }\n    bossHPStyling() {\n        if (this.type !== \"boss\") return \"0 (0%)\";\n        const boss = this.mobs.find(m=>m.event === \"boss\")\n        return `${formatToUnits(boss.hp,2)} (${Math.round(100*boss.hp/boss.maxHP())+\"%\"})`;\n    }\n    bossDifficulty() {\n        return 0;\n        //if (this.type === \"regular\") return 0;\n        //const boss = DungeonManager.bossByDungeon(this.id);\n        //return MonsterHall.monsterKillCount(boss);\n    }\n    buffTick(type) {\n        this.party.heroes.forEach(hero => {\n            hero.buffTick(type);\n        })\n        this.mobs.forEach(enemy => {\n            enemy.buffTick(type);\n        })\n    }\n    passiveCheck(type) {\n        this.party.heroes.forEach(hero => {\n            hero.passiveCheck(type);\n        })\n        this.mobs.forEach(enemy => {\n            enemy.passiveCheck(type);\n        })\n    }\n    materialGain() {\n        const amt = this.floorClear\n    }\n    getRewards() {\n        return new idAmt(\"M201\",1);\n    }\n}\n\nconst DungeonManager = {\n    dungeons : [],\n    dungeonView : null,\n    speed : 1500,\n    createSave() {\n        const save = {};\n        save.dungeons = [];\n        this.dungeons.forEach(d => {\n            save.dungeons.push(d.createSave());\n        });\n        save.dungeonPaid = this.dungeonPaid;\n        save.speed = this.speed;\n        save.bossesBeat = this.bossesBeat;\n        save.partySize = this.partySize;\n        return save;\n    },\n    addDungeon(dungeon) {\n        this.dungeons.push(dungeon);\n        AreaManager.addDungeon(dungeon);\n    },\n    loadSave(save) {\n        save.dungeons.forEach(d => {\n            const dungeon = DungeonManager.dungeonByID(d.id);\n            dungeon.loadSave(d);\n        });\n        this.speed = save.speed;\n        if (typeof save.dungeonPaid !== \"undefined\") this.dungeonPaid = save.dungeonPaid;\n        if (typeof save.bossesBeat !== \"undefined\") this.bossesBeat = save.bossesBeat;\n        if (typeof save.partySize !== \"undefined\") this.partySize = save.partySize;\n    },\n    addTime(t) {\n        this.dungeons.forEach(dungeon => {\n            dungeon.addTime(t);\n        });\n    },\n    dungeonStatus(dungeonID) {\n        return this.dungeons.find(d=>d.id===dungeonID).status;\n    },\n    createDungeon(dungeonID,floorSkip) {\n        const party = PartyCreator.lockParty();\n        const dungeon = this.dungeonByID(dungeonID);\n        dungeon.floor = floorSkip ? dungeon.maxFloor : 1;\n        dungeon.status = DungeonStatus.ADVENTURING;\n        this.dungeonView = dungeonID;\n        dungeon.initializeParty(party);\n        dungeon.resetFloor();\n        initializeSideBarDungeon();\n    },\n    dungeonByID(dungeonID) {\n        return this.dungeons.find(d => d.id === dungeonID);\n    },\n    abandonCurrentDungeon() {\n        const dungeon = this.dungeonByID(this.dungeonView);\n        dungeon.resetDungeon();\n    },\n    abandonAllDungeons() {\n        this.dungeons.forEach(dungeon => {\n            dungeon.resetDungeon();\n        })\n    },\n    bossCount() {\n        const bossDung = this.dungeons.filter(d => d.type === \"boss\")\n        return bossDung.filter(d => d.maxFloor > 0).length;\n    }\n};"],"file":"dungeons.js"}