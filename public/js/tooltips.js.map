{"version":3,"sources":["../../src/js/tooltips.js"],"names":["Tooltip","props","Object","assign","id","prop","type","BuffManager","idToBuff","DungeonManager","dungeonByID","GuildManager","idToGuild","HeroManager","idToHero","ResourceManager","idToMaterial","MobManager","idToMob","Shop","idToPerk","recipeList","idToItem","SkillManager","idToSkill","WorkerManager","workerByID","icon","hashtagReplace","iconText","generateIcon","substring","TooltipManager","tooltips","addTooltip","tooltip","push","findTooltip","find","generateTooltip","e","tooltipsContainer","$","tooltipID","currentTarget","attr","tooltipEV","getBoundingClientRect","positionBottom","window","innerHeight","top","positionLeft","left","width","innerWidth","defaultStyles","position","bottom","undefined","generatedTooltip","addClass","css","appendTo","isFont","backgroundImage","html","tooltipDetails","title","titleText","description","descText","destroyTooltip","setTimeout","remove","document","on","stopPropagation","includes","start","indexOf","end","tooltipValue"],"mappings":"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","sourcesContent":["class Tooltip {\r\n  constructor(props) {\r\n    Object.assign(this, props);\r\n  }\r\n  tooltipValue(id,prop) {\r\n    if (this.type === \"value\") return id;\r\n    else if (this.type === \"buff\") return BuffManager.idToBuff(id)[prop];\r\n    else if (this.type === \"dungeon\") return DungeonManager.dungeonByID(id)[prop];\r\n    else if (this.type === \"guild\") return GuildManager.idToGuild(id)[prop];\r\n    else if (this.type === \"hero\") return HeroManager.idToHero(id)[prop];\r\n    else if (this.type === \"material\") return ResourceManager.idToMaterial(id)[prop];\r\n    else if (this.type === \"mob\") return MobManager.idToMob(id)[prop];\r\n    else if (this.type === \"perk\") return Shop.idToPerk(id)[prop];\r\n    else if (this.type === \"recipe\") return recipeList.idToItem(id)[prop];\r\n    else if (this.type === \"skill\") return SkillManager.idToSkill(id)[prop];\r\n    else if (this.type === \"worker\") return WorkerManager.workerByID(id)[prop];\r\n  }\r\n  generateIcon(id) {\r\n    if (!this.icon) return null;\r\n    return hashtagReplace(this, id, this.icon);\r\n  }\r\n  isFont(id) {\r\n    const iconText = this.generateIcon(id);\r\n    return iconText ? iconText.substring(0,2) === \"<i\" : false;\r\n  }\r\n}\r\n\r\nconst TooltipManager = {\r\n  tooltips: [],\r\n  addTooltip(tooltip) {\r\n    this.tooltips.push(tooltip)\r\n  },\r\n  findTooltip(id) {\r\n    return this.tooltips.find(tooltip => tooltip.id === id)\r\n  },\r\n}\r\n\r\nfunction generateTooltip(e) {\r\n  const tooltipsContainer = $(\"#tooltips\");\r\n  const tooltipID = $(e.currentTarget).attr(\"data-tooltip\");\r\n  const tooltipEV = $(e.currentTarget).attr(\"data-tooltip-value\");\r\n  const tooltip = TooltipManager.findTooltip(tooltipID);\r\n  const props = e.currentTarget.getBoundingClientRect();\r\n\r\n  let positionBottom = ( window.innerHeight - props.top ) + 10;\r\n  if (props.top < 100) positionBottom = ( window.innerHeight - props.top ) - 100;\r\n  let positionLeft = props.left + (props.width / 2) - 175;\r\n  if (positionLeft < 0) positionLeft = 5;\r\n  while (positionLeft > window.innerWidth - 350) positionLeft -= 5;\r\n\r\n  const defaultStyles = {\r\n    position: \"absolute\",\r\n    bottom: positionBottom,\r\n    left: positionLeft\r\n  }\r\n  \r\n  if (tooltip === undefined) return;\r\n  const generatedTooltip = $(\"<div/>\").addClass(\"tooltip-container\").css(defaultStyles).appendTo(tooltipsContainer);\r\n  // If icon is image, render image\r\n  if (tooltip.icon && !tooltip.isFont(tooltipEV)) $(\"<div/>\").addClass(\"tooltip-icon\").css({backgroundImage: `url(${tooltip.generateIcon(tooltipEV)})`}).appendTo(generatedTooltip);\r\n  // If icon is font, render font icon\r\n  if (tooltip.icon && tooltip.isFont(tooltipEV)) $(\"<div/>\").addClass(\"tooltip-icon\").html(tooltip.generateIcon(tooltipEV)).appendTo(generatedTooltip);\r\n\r\n  const tooltipDetails = $(\"<div/>\").addClass(\"tooltip-details\").appendTo(generatedTooltip);\r\n  \r\n  if (tooltip.title) {\r\n    const titleText = tooltipEV ? hashtagReplace(tooltip,tooltipEV,tooltip.title) : tooltip.title;\r\n    $(\"<div/>\").addClass(\"tooltip-title\").html(titleText).appendTo(tooltipDetails);\r\n  }\r\n  if (tooltip.description) {\r\n    const descText = tooltipEV ? hashtagReplace(tooltip,tooltipEV,tooltip.description) : tooltip.description;\r\n    $(\"<div/>\").addClass(\"tooltip-description\").html(descText).appendTo(tooltipDetails);\r\n  }\r\n\r\n  return generatedTooltip;\r\n}\r\n\r\nfunction destroyTooltip(e) {\r\n  $(\".tooltip-container\").addClass(\"destroyingTooltip\");\r\n  setTimeout(() => {\r\n    $(\".tooltip-container.destroyingTooltip\").remove();\r\n  }, 200)\r\n}\r\n\r\n$(document).on(\"mouseenter\", \".tooltip\", (e) => {\r\n  e.stopPropagation();\r\n  destroyTooltip(); // Ensures removal of any \"stuck\" tooltips before generating new tooltip\r\n  generateTooltip(e);\r\n});\r\n\r\n$(document).on(\"mouseleave\", \".tooltip\", (e) => {\r\n  destroyTooltip(e);\r\n});\r\n\r\nfunction hashtagReplace(tooltip, id, html) {\r\n  if (!html.includes(\"#\")) return html;\r\n  const start = html.indexOf(\"#\");\r\n  const end = html.indexOf(\"#\",start+1);\r\n  const prop = html.substring(start+1,end);\r\n  return hashtagReplace(tooltip,id,html.substring(0,start)+tooltip.tooltipValue(id,prop)+html.substring(end+1));\r\n}"],"file":"tooltips.js"}